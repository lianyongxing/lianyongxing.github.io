(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{396:function(s,t,a){s.exports=a.p+"assets/img/image-20200803211956594.46a7c558.png"},648:function(s,t,a){"use strict";a.r(t);var i=a(44),e=Object(i.a)({},(function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[i("h1",{attrs:{id:"transformer"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#transformer"}},[s._v("#")]),s._v(" Transformer")]),s._v(" "),i("h2",{attrs:{id:"embedding"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#embedding"}},[s._v("#")]),s._v(" Embedding")]),s._v(" "),i("h3",{attrs:{id:"对input进行表示"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#对input进行表示"}},[s._v("#")]),s._v(" 对input进行表示")]),s._v(" "),i("p",[s._v("普通的表示为one-hot coding")]),s._v(" "),i("h3",{attrs:{id:"word-embedding"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#word-embedding"}},[s._v("#")]),s._v(" word embedding")]),s._v(" "),i("p",[s._v("one-hot表达结果稀疏，不能表达word与word之间的特征，因此对词进行embedding，用短向量表达word的属性")]),s._v(" "),i("h3",{attrs:{id:"positional-embedding"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#positional-embedding"}},[s._v("#")]),s._v(" Positional embedding")]),s._v(" "),i("p",[s._v("对每个word进行embedding作为input表达，但是这其中不包含句子中单词的位置信息。RNN可以在任何地方对同一个word使用一个相同的向量，是因为RNN是按顺序对句子进行处理，一次一个word，但是在transformer中，输入句子的word是同时处理的，没有考虑词的排序和位置信息")]),s._v(" "),i("p",[s._v("对此，加入了Positional embedding，position encoding和word embedding相加就可以得到embedding with position")]),s._v(" "),i("p",[s._v("有两种方式：")]),s._v(" "),i("ol",[i("li",[s._v("通过训练学习position encoding向量")])]),s._v(" "),i("p",[s._v("2.通过公式计算position encoding向量，实验中效果与第一种近似，因此用第二种方法，优点不需要训练参数")]),s._v(" "),i("p",[s._v("计算公式为")]),s._v(" "),i("p",[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("P")]),i("mi",[s._v("E")]),i("mo",[s._v("(")]),i("mi",[s._v("p")]),i("mi",[s._v("o")]),i("mi",[s._v("s")]),i("mo",{attrs:{separator:"true"}},[s._v(",")]),i("mn",[s._v("2")]),i("mi",[s._v("i")]),i("mo",[s._v(")")]),i("mo",[s._v("=")]),i("mi",[s._v("s")]),i("mi",[s._v("i")]),i("mi",[s._v("n")]),i("mo",[s._v("(")]),i("mi",[s._v("p")]),i("mi",[s._v("o")]),i("mi",[s._v("s")]),i("mi",{attrs:{mathvariant:"normal"}},[s._v("/")]),i("mn",[s._v("1")]),i("mn",[s._v("0")]),i("mn",[s._v("0")]),i("mn",[s._v("0")]),i("msup",[i("mn",[s._v("0")]),i("mrow",[i("mn",[s._v("2")]),i("mi",[s._v("i")]),i("mi",{attrs:{mathvariant:"normal"}},[s._v("/")]),i("msub",[i("mi",[s._v("d")]),i("mrow",[i("mi",[s._v("m")]),i("mi",[s._v("o")]),i("mi",[s._v("d")]),i("mi",[s._v("e")]),i("mi",[s._v("l")])],1)],1)],1)],1),i("mo",[s._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("PE(pos,2i) = sin(pos/10000^{2i/d_{model}})\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.938em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"1.188em","vertical-align":"-0.25em"}}),i("span",{staticClass:"base displaystyle textstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("P")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[s._v("E")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("p")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mpunct"},[s._v(",")]),i("span",{staticClass:"mord mathrm"},[s._v("2")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mord mathit"},[s._v("n")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("p")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mord mathrm"},[s._v("/")]),i("span",{staticClass:"mord mathrm"},[s._v("1")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[i("span",{staticClass:"mord scriptstyle uncramped"},[i("span",{staticClass:"mord mathrm"},[s._v("2")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mord mathrm"},[s._v("/")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15122857142857138em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[i("span",{staticClass:"mord scriptscriptstyle cramped"},[i("span",{staticClass:"mord mathit"},[s._v("m")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),i("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),i("p",[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("P")]),i("mi",[s._v("E")]),i("mo",[s._v("(")]),i("mi",[s._v("p")]),i("mi",[s._v("o")]),i("mi",[s._v("s")]),i("mo",{attrs:{separator:"true"}},[s._v(",")]),i("mn",[s._v("2")]),i("mi",[s._v("i")]),i("mo",[s._v("+")]),i("mn",[s._v("1")]),i("mo",[s._v(")")]),i("mo",[s._v("=")]),i("mi",[s._v("c")]),i("mi",[s._v("o")]),i("mi",[s._v("s")]),i("mo",[s._v("(")]),i("mi",[s._v("p")]),i("mi",[s._v("o")]),i("mi",[s._v("s")]),i("mi",{attrs:{mathvariant:"normal"}},[s._v("/")]),i("mn",[s._v("1")]),i("mn",[s._v("0")]),i("mn",[s._v("0")]),i("mn",[s._v("0")]),i("msup",[i("mn",[s._v("0")]),i("mrow",[i("mn",[s._v("2")]),i("mi",[s._v("i")]),i("mi",{attrs:{mathvariant:"normal"}},[s._v("/")]),i("msub",[i("mi",[s._v("d")]),i("mrow",[i("mi",[s._v("m")]),i("mi",[s._v("o")]),i("mi",[s._v("d")]),i("mi",[s._v("e")]),i("mi",[s._v("l")])],1)],1)],1)],1),i("mo",[s._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("PE(pos,2i+1) = cos(pos/10000^{2i/d_{model}})\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.938em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"1.188em","vertical-align":"-0.25em"}}),i("span",{staticClass:"base displaystyle textstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("P")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[s._v("E")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("p")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mpunct"},[s._v(",")]),i("span",{staticClass:"mord mathrm"},[s._v("2")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mord mathrm"},[s._v("1")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mord mathit"},[s._v("c")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("p")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("s")]),i("span",{staticClass:"mord mathrm"},[s._v("/")]),i("span",{staticClass:"mord mathrm"},[s._v("1")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"-0.413em","margin-right":"0.05em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[i("span",{staticClass:"mord scriptstyle uncramped"},[i("span",{staticClass:"mord mathrm"},[s._v("2")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mord mathrm"},[s._v("/")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15122857142857138em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[i("span",{staticClass:"mord scriptscriptstyle cramped"},[i("span",{staticClass:"mord mathit"},[s._v("m")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),i("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),i("p",[s._v("相当于每个embedding的维度上，不同的位置都是周期变化的，然后随着embedding维度的增加，这个变化是越来越慢（每个维度都对应一个正弦曲线，这样可以让模型会更轻松的通过位置来学习）")]),s._v(" "),i("h2",{attrs:{id:"encoder"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#encoder"}},[s._v("#")]),s._v(" Encoder")]),s._v(" "),i("p",[s._v("encoder由6个相乘的Layer叠成，每个layer包含两个sub-layer，第一层是multi-head self-attention mechanism，第二个是simple、position wise fully connected feed-forward netwok")]),s._v(" "),i("h3",{attrs:{id:"self-attention"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#self-attention"}},[s._v("#")]),s._v(" Self-attention")]),s._v(" "),i("p",[s._v("一句话有5个单词，每个单词，用一个向量表示，比如512维")]),s._v(" "),i("p",[s._v("（啊：1x512），将其计算为三个256维的向量key、query、value")]),s._v(" "),i("p",[s._v("将每个字的query与所有字的key之间计算点积，因此获得了5个注意力得分，将其通过一个softmax归一化，然后将其分别乘以value，得到每个字最终的score，将其相加得到第一个字最终的输出")]),s._v(" "),i("p",[s._v("将一个字的embedding进行分割成h份，对每份用不同的W_q、W_k、W_v对得到多个key、query、value，其实就是多头的，multi-head self-attention")]),s._v(" "),i("p",[s._v("这里"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("Q")]),i("mo",[s._v("∗")]),i("msup",[i("mi",[s._v("K")]),i("mrow",[i("mi",[s._v("T")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("Q*K^{T}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.8413309999999999em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"1.035771em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"base textstyle uncramped"},[i("span",{staticClass:"mord mathit"},[s._v("Q")]),i("span",{staticClass:"mbin"},[s._v("∗")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[s._v("K")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"-0.363em","margin-right":"0.05em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[i("span",{staticClass:"mord scriptstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("T")])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("，Q和K的转置求点积，点积的几何意义是距离（两个模乘以夹角的余弦），当两个词向量越相似说明这个值越大（夹角越小），是一种距离的度量，最终得到的称为注意力矩阵。（实际上求点积之后，除以headsize的平方根，是因为防止headsize增大的时候，点积过大，因此进行缩放）")]),s._v(" "),i("p",[s._v("Tips：实际进行时，是用几个句子一起作为一个batch输入的，因此句子的长短是不一样的，所以需要按照最大长度的句子，为短句子补充padding，但是这样的话在进行softmax的时候，就会出现，注意力矩阵会有很多0")]),s._v(" "),i("div",{attrs:{align:"center"}},[i("img",{attrs:{src:a(396),width:"80%"}})]),s._v(" "),i("p",[s._v("但是做完softmax，这些值都成为1了，因为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("e")]),i("mi",[s._v("x")]),i("mi",[s._v("p")]),i("mn",[s._v("0")]),i("mo",[s._v("=")]),i("mn",[s._v("1")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("exp0=1")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.64444em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"0.8388800000000001em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"base textstyle uncramped"},[i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit"},[s._v("x")]),i("span",{staticClass:"mord mathit"},[s._v("p")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),s._v("，因此要给这些无效的区域加一个很大的偏置（很负的数），进行softmax后就变成了0")]),s._v(" "),i("h3",{attrs:{id:"add-and-norm"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#add-and-norm"}},[s._v("#")]),s._v(" Add and norm")]),s._v(" "),i("p",[s._v("Add是残差链接，norm是layer_normalization，这就是一个attention-block")]),s._v(" "),i("p",[s._v("每次输出是"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("A")]),i("mi",[s._v("t")]),i("mi",[s._v("t")]),i("mi",[s._v("e")]),i("mi",[s._v("n")]),i("mi",[s._v("t")]),i("mi",[s._v("i")]),i("mi",[s._v("o")]),i("mi",[s._v("n")]),i("mo",[s._v("(")]),i("mi",[s._v("Q")]),i("mo",{attrs:{separator:"true"}},[s._v(",")]),i("mi",[s._v("K")]),i("mo",{attrs:{separator:"true"}},[s._v(",")]),i("mi",[s._v("V")]),i("mo",[s._v(")")]),i("mo",[s._v("+")]),i("msub",[i("mi",[s._v("X")]),i("mrow",[i("mi",[s._v("e")]),i("mi",[s._v("m")]),i("mi",[s._v("b")]),i("mi",[s._v("e")]),i("mi",[s._v("d")]),i("mi",[s._v("d")]),i("mi",[s._v("i")]),i("mi",[s._v("n")]),i("mi",[s._v("g")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("Attention(Q, K, V) + X_{embedding}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"1.036108em","vertical-align":"-0.286108em"}}),i("span",{staticClass:"base textstyle uncramped"},[i("span",{staticClass:"mord mathit"},[s._v("A")]),i("span",{staticClass:"mord mathit"},[s._v("t")]),i("span",{staticClass:"mord mathit"},[s._v("t")]),i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit"},[s._v("n")]),i("span",{staticClass:"mord mathit"},[s._v("t")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mord mathit"},[s._v("o")]),i("span",{staticClass:"mord mathit"},[s._v("n")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("Q")]),i("span",{staticClass:"mpunct"},[s._v(",")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07153em"}},[s._v("K")]),i("span",{staticClass:"mpunct"},[s._v(",")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.22222em"}},[s._v("V")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.07847em"}},[s._v("X")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.07847em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle cramped"},[i("span",{staticClass:"mord scriptstyle cramped"},[i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit"},[s._v("m")]),i("span",{staticClass:"mord mathit"},[s._v("b")]),i("span",{staticClass:"mord mathit"},[s._v("e")]),i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"mord mathit"},[s._v("d")]),i("span",{staticClass:"mord mathit"},[s._v("i")]),i("span",{staticClass:"mord mathit"},[s._v("n")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("g")])])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])]),s._v("，之后的运算里，没经过一个模块的运算，都进行残差链接，从而梯度反向传播的时候可以走捷径。LayerNorm就是Batchnorm，")]),s._v(" "),i("p",[s._v("最后加上"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("α")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\alpha")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"base textstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.0037em"}},[s._v("α")])])])]),s._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("β")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\beta")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"base textstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05278em"}},[s._v("β")])])])]),s._v("，是为了弥补归一化的损失")]),s._v(" "),i("h3",{attrs:{id:"feed-forward-network"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#feed-forward-network"}},[s._v("#")]),s._v(" Feed-forward network")]),s._v(" "),i("p",[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",[i("semantics",[i("mrow",[i("mi",[s._v("F")]),i("mi",[s._v("F")]),i("mi",[s._v("N")]),i("mo",[s._v("(")]),i("mi",[s._v("x")]),i("mo",[s._v(")")]),i("mo",[s._v("=")]),i("mi",[s._v("m")]),i("mi",[s._v("a")]),i("mi",[s._v("x")]),i("mo",[s._v("(")]),i("mn",[s._v("0")]),i("mo",{attrs:{separator:"true"}},[s._v(",")]),i("mi",[s._v("x")]),i("msub",[i("mi",[s._v("W")]),i("mn",[s._v("1")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",[s._v("b")]),i("mn",[s._v("1")])],1),i("mo",[s._v(")")]),i("msub",[i("mi",[s._v("W")]),i("mn",[s._v("2")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",[s._v("b")]),i("mn",[s._v("2")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("FFN(x) = max(0, xW_1+b_1)W_2+b_2\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"strut",staticStyle:{height:"0.75em"}}),i("span",{staticClass:"strut bottom",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"base displaystyle textstyle uncramped"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathit"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mord mathit"},[s._v("m")]),i("span",{staticClass:"mord mathit"},[s._v("a")]),i("span",{staticClass:"mord mathit"},[s._v("x")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathrm"},[s._v("0")]),i("span",{staticClass:"mpunct"},[s._v(",")]),i("span",{staticClass:"mord mathit"},[s._v("x")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("W")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.13889em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle cramped"},[i("span",{staticClass:"mord mathrm"},[s._v("1")])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit"},[s._v("b")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle cramped"},[i("span",{staticClass:"mord mathrm"},[s._v("1")])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("W")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.13889em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle cramped"},[i("span",{staticClass:"mord mathrm"},[s._v("2")])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathit"},[s._v("b")]),i("span",{staticClass:"vlist"},[i("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),i("span",{staticClass:"reset-textstyle scriptstyle cramped"},[i("span",{staticClass:"mord mathrm"},[s._v("2")])])]),i("span",{staticClass:"baseline-fix"},[i("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[i("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])])])])])])]),s._v(" "),i("p",[s._v("就是2个全连接层")]),s._v(" "),i("h2",{attrs:{id:"架构图"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#架构图"}},[s._v("#")]),s._v(" 架构图")]),s._v(" "),i("div",{attrs:{align:"center"}},[i("img",{attrs:{src:"https://pic4.zhimg.com/v2-3b06c85bdf7daccad710ebe9a096f0e8_r.jpg",width:"60%"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);