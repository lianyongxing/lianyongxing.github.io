(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{481:function(t,a,r){t.exports=r.p+"assets/img/C3528909-E77E-43A8-AC8A-601D08847007.2b5616ba.png"},482:function(t,a,r){t.exports=r.p+"assets/img/9EF16CF9-96ED-4BC1-849A-4AF388755660.287879aa.png"},483:function(t,a,r){t.exports=r.p+"assets/img/0BF6AF3F-3D05-4119-8F04-0AD62C730BC3.75658209.png"},484:function(t,a,r){t.exports=r.p+"assets/img/AA94C0A4-98E9-4F89-BD38-8C02F8DAABEA.d26e9bd3.png"},485:function(t,a,r){t.exports=r.p+"assets/img/73C58B25-29A7-475A-89E4-2107A555054B.b8020e04.png"},486:function(t,a,r){t.exports=r.p+"assets/img/715E70B5-5A86-4127-8610-EF25F161E702.3c4d27d5.png"},676:function(t,a,r){"use strict";r.r(a);var s=r(44),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"paxos算法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#paxos算法"}},[t._v("#")]),t._v(" Paxos算法")]),t._v(" "),s("p",[t._v('解决分布式场景下的"一致性问题"的算法')]),t._v(" "),s("h2",{attrs:{id:"basic-paxos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#basic-paxos"}},[t._v("#")]),t._v(" Basic Paxos")]),t._v(" "),s("h3",{attrs:{id:"角色介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#角色介绍"}},[t._v("#")]),t._v(" 角色介绍")]),t._v(" "),s("ul",[s("li",[t._v("Client：系统的外部角色，请求的发起人。像民众。")]),t._v(" "),s("li",[t._v("Propser：接受Client的请求，向集群提出提议（propose），并在冲突发生时，起到冲突调节的作用。像议员，替民众提出议案。")]),t._v(" "),s("li",[t._v("Acceptor（Voter）：提议投票和接收者，只有在形成法定人数(quorum)时，提议才会最终被接受。像国会。")]),t._v(" "),s("li",[t._v("Learner：提议接受者，backup，备份，对集群一致性没什么影响。像记录员。")])]),t._v(" "),s("h3",{attrs:{id:"步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[t._v("#")]),t._v(" 步骤")]),t._v(" "),s("h4",{attrs:{id:"_1a：prepare"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1a：prepare"}},[t._v("#")]),t._v(" 1a：Prepare")]),t._v(" "),s("p",[t._v("proposer提出一个提案，编号为N，N大于proposer之前提出的案件编号，请求acceptor的quorum接受")]),t._v(" "),s("h4",{attrs:{id:"_1b：promise"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1b：promise"}},[t._v("#")]),t._v(" 1b：Promise")]),t._v(" "),s("p",[t._v("如果N大于此acceptor之前接受的任何提案编号则接受，否则拒绝")]),t._v(" "),s("h4",{attrs:{id:"_2a：accept"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2a：accept"}},[t._v("#")]),t._v(" 2a：Accept")]),t._v(" "),s("p",[t._v("如果达到了多数派，proposer会发出accept请求，此请求包含提案编号N和内容")]),t._v(" "),s("h4",{attrs:{id:"_2b：accepted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2b：accepted"}},[t._v("#")]),t._v(" 2b：Accepted")]),t._v(" "),s("p",[t._v("如果此acceptor再次期间没有收到任何编号大于N的提案，则接受此案件的内容，否则忽略")]),t._v(" "),s("h4",{attrs:{id:"看图说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#看图说明"}},[t._v("#")]),t._v(" 看图说明")]),t._v(" "),s("h5",{attrs:{id:"正常情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正常情况"}},[t._v("#")]),t._v(" 正常情况")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(481),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("h5",{attrs:{id:"部分节点失败，但是达到大多数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部分节点失败，但是达到大多数"}},[t._v("#")]),t._v(" 部分节点失败，但是达到大多数")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(482),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("h5",{attrs:{id:"proposer失败"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proposer失败"}},[t._v("#")]),t._v(" Proposer失败")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(483),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("h3",{attrs:{id:"一个常见的问题-活锁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个常见的问题-活锁"}},[t._v("#")]),t._v(" 一个常见的问题——活锁")]),t._v(" "),s("p",[t._v("有时候出现这种情况：1号提案发出，acctepor通过1号提案，这时2号提案发出（一号提案内容还没到达），acctepor通过2号提案，这时1号提案内容到达，因此抛弃1号提案内容（1号提案发现发现自己被抛弃了，于是提3号提案过去），3号提案发出，acctepor通过3号提案，2号提案内容到达（发现自己被抛弃了，于是提4号提案过去），不断往复，于是无法真正接受某个提案的内容，只是在不断变换讨论哪个提案。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(484),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("p",[t._v("解决方案：就是给一个随机的时间，被占了后先等一等，不立即发送，然后在随机等一等。")]),t._v(" "),s("p",[t._v("其他问题：")]),t._v(" "),s("ul",[s("li",[t._v("难实现，角色太多了")]),t._v(" "),s("li",[t._v("2轮RPC，第一轮确定讨论几号提案，第二轮确定内容接不接受，效率低")]),t._v(" "),s("li",[t._v("活锁")])]),t._v(" "),s("h2",{attrs:{id:"multi-paxos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#multi-paxos"}},[t._v("#")]),t._v(" Multi Paxos")]),t._v(" "),s("p",[t._v("新概念，Leader：唯一的propser，所有的请求都经过此Leader")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(485),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("p",[t._v("因此不会有人跟Leader去抢提交提案")]),t._v(" "),s("p",[t._v("这种方法需要首先竞选Leader，竞选后直接提交案件和内容，就不需要先问讨论几号提案了，如果Leader挂了就重新竞选Leader。")]),t._v(" "),s("p",[t._v("这种方法进一步减少了角色，进一步简化")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:r(486),width:"70%",height:"70%",alt:"图片名称"}})]),t._v(" "),s("p",[t._v("例如上图中，3个Server，其中一个Leader，2个Slave")])])}),[],!1,null,null,null);a.default=e.exports}}]);