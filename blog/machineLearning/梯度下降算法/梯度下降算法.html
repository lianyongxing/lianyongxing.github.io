<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>梯度下降算法 | LIANYONGXING. BLOG</title>
    <meta name="description" content="May the force be with u.">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="ficon.jpeg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.a5323663.css" as="style"><link rel="preload" href="/assets/js/app.acaacfed.js" as="script"><link rel="preload" href="/assets/js/2.858fe96a.js" as="script"><link rel="preload" href="/assets/js/32.741f73e3.js" as="script"><link rel="prefetch" href="/assets/js/10.652038c7.js"><link rel="prefetch" href="/assets/js/100.2dd9d0f2.js"><link rel="prefetch" href="/assets/js/101.487a243a.js"><link rel="prefetch" href="/assets/js/102.0c61121f.js"><link rel="prefetch" href="/assets/js/103.4dbe63e3.js"><link rel="prefetch" href="/assets/js/104.7f502b03.js"><link rel="prefetch" href="/assets/js/105.6e83f9e6.js"><link rel="prefetch" href="/assets/js/106.5409dca1.js"><link rel="prefetch" href="/assets/js/107.7ad54acd.js"><link rel="prefetch" href="/assets/js/108.3486f36a.js"><link rel="prefetch" href="/assets/js/109.5ee4cd3b.js"><link rel="prefetch" href="/assets/js/11.4f8ea0df.js"><link rel="prefetch" href="/assets/js/110.6417250e.js"><link rel="prefetch" href="/assets/js/111.ded28c89.js"><link rel="prefetch" href="/assets/js/112.94f5b6c6.js"><link rel="prefetch" href="/assets/js/113.3b1fe42e.js"><link rel="prefetch" href="/assets/js/114.0e643f0c.js"><link rel="prefetch" href="/assets/js/115.32a16f28.js"><link rel="prefetch" href="/assets/js/12.a9ef9aaf.js"><link rel="prefetch" href="/assets/js/13.acff38a0.js"><link rel="prefetch" href="/assets/js/14.113e66b1.js"><link rel="prefetch" href="/assets/js/15.19b59d69.js"><link rel="prefetch" href="/assets/js/16.4ee77b14.js"><link rel="prefetch" href="/assets/js/17.a5b6d566.js"><link rel="prefetch" href="/assets/js/18.744a9950.js"><link rel="prefetch" href="/assets/js/19.fd9e7099.js"><link rel="prefetch" href="/assets/js/20.66903b5c.js"><link rel="prefetch" href="/assets/js/21.c98f5d06.js"><link rel="prefetch" href="/assets/js/22.a0056c91.js"><link rel="prefetch" href="/assets/js/23.73369199.js"><link rel="prefetch" href="/assets/js/24.dc5b3fc5.js"><link rel="prefetch" href="/assets/js/25.bf612edb.js"><link rel="prefetch" href="/assets/js/26.b9dd7686.js"><link rel="prefetch" href="/assets/js/27.371379cd.js"><link rel="prefetch" href="/assets/js/28.4a33fe83.js"><link rel="prefetch" href="/assets/js/29.be42af3d.js"><link rel="prefetch" href="/assets/js/3.47952932.js"><link rel="prefetch" href="/assets/js/30.37bd8e9e.js"><link rel="prefetch" href="/assets/js/31.58f89f44.js"><link rel="prefetch" href="/assets/js/33.a9c7dcb5.js"><link rel="prefetch" href="/assets/js/34.c3f829b5.js"><link rel="prefetch" href="/assets/js/35.29c897d0.js"><link rel="prefetch" href="/assets/js/36.1e02f622.js"><link rel="prefetch" href="/assets/js/37.a1d23a14.js"><link rel="prefetch" href="/assets/js/38.06964860.js"><link rel="prefetch" href="/assets/js/39.384a454e.js"><link rel="prefetch" href="/assets/js/4.7feb14c8.js"><link rel="prefetch" href="/assets/js/40.c7e4dfb7.js"><link rel="prefetch" href="/assets/js/41.3e5c5125.js"><link rel="prefetch" href="/assets/js/42.dcf19498.js"><link rel="prefetch" href="/assets/js/43.54203bcb.js"><link rel="prefetch" href="/assets/js/44.9cccb36c.js"><link rel="prefetch" href="/assets/js/45.3ce2a56c.js"><link rel="prefetch" href="/assets/js/46.17aac222.js"><link rel="prefetch" href="/assets/js/47.57ed0257.js"><link rel="prefetch" href="/assets/js/48.8baebce7.js"><link rel="prefetch" href="/assets/js/49.7eb16be5.js"><link rel="prefetch" href="/assets/js/5.55c31470.js"><link rel="prefetch" href="/assets/js/50.06274b55.js"><link rel="prefetch" href="/assets/js/51.b50e24a8.js"><link rel="prefetch" href="/assets/js/52.7b92239f.js"><link rel="prefetch" href="/assets/js/53.fb7cbb6a.js"><link rel="prefetch" href="/assets/js/54.d047b5f1.js"><link rel="prefetch" href="/assets/js/55.6e2fd120.js"><link rel="prefetch" href="/assets/js/56.fa7ee707.js"><link rel="prefetch" href="/assets/js/57.31b7d0a7.js"><link rel="prefetch" href="/assets/js/58.80cddbc7.js"><link rel="prefetch" href="/assets/js/59.92b2b0f2.js"><link rel="prefetch" href="/assets/js/6.792ce084.js"><link rel="prefetch" href="/assets/js/60.9ab8e458.js"><link rel="prefetch" href="/assets/js/61.b3abbf87.js"><link rel="prefetch" href="/assets/js/62.2bde1ed2.js"><link rel="prefetch" href="/assets/js/63.39cf6423.js"><link rel="prefetch" href="/assets/js/64.c839079e.js"><link rel="prefetch" href="/assets/js/65.ea1754c1.js"><link rel="prefetch" href="/assets/js/66.802ec528.js"><link rel="prefetch" href="/assets/js/67.a30d6fff.js"><link rel="prefetch" href="/assets/js/68.d98ac090.js"><link rel="prefetch" href="/assets/js/69.083b1217.js"><link rel="prefetch" href="/assets/js/7.3964fa52.js"><link rel="prefetch" href="/assets/js/70.272720ba.js"><link rel="prefetch" href="/assets/js/71.386b54d7.js"><link rel="prefetch" href="/assets/js/72.005e615f.js"><link rel="prefetch" href="/assets/js/73.b1266355.js"><link rel="prefetch" href="/assets/js/74.9ab08f58.js"><link rel="prefetch" href="/assets/js/75.eefe4ff0.js"><link rel="prefetch" href="/assets/js/76.e4162716.js"><link rel="prefetch" href="/assets/js/77.e1ead4d7.js"><link rel="prefetch" href="/assets/js/78.ae9b9cc3.js"><link rel="prefetch" href="/assets/js/79.eeaf4627.js"><link rel="prefetch" href="/assets/js/8.5ccbfc45.js"><link rel="prefetch" href="/assets/js/80.0272858c.js"><link rel="prefetch" href="/assets/js/81.bbc0907f.js"><link rel="prefetch" href="/assets/js/82.4de7fcc4.js"><link rel="prefetch" href="/assets/js/83.2ad342e1.js"><link rel="prefetch" href="/assets/js/84.3398b3bb.js"><link rel="prefetch" href="/assets/js/85.be446d7c.js"><link rel="prefetch" href="/assets/js/86.1ef2094d.js"><link rel="prefetch" href="/assets/js/87.53795a29.js"><link rel="prefetch" href="/assets/js/88.1c3ba029.js"><link rel="prefetch" href="/assets/js/89.a4797bc8.js"><link rel="prefetch" href="/assets/js/9.1e695694.js"><link rel="prefetch" href="/assets/js/90.12ceffe8.js"><link rel="prefetch" href="/assets/js/91.40c9fc92.js"><link rel="prefetch" href="/assets/js/92.9648154b.js"><link rel="prefetch" href="/assets/js/93.d4e90cec.js"><link rel="prefetch" href="/assets/js/94.50b5eb64.js"><link rel="prefetch" href="/assets/js/95.9d54c125.js"><link rel="prefetch" href="/assets/js/96.fce496cb.js"><link rel="prefetch" href="/assets/js/97.86a56b4e.js"><link rel="prefetch" href="/assets/js/98.cf20fa6d.js"><link rel="prefetch" href="/assets/js/99.92c0c3e3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a5323663.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">LIANYONGXING. BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/index.html" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/NLP/" class="nav-link">
  NLP
</a></li><li class="dropdown-item"><!----> <a href="/blog/machineLearning/" class="nav-link router-link-active">
  MachineLearning
</a></li><li class="dropdown-item"><!----> <a href="/blog/Papers/" class="nav-link">
  Papers
</a></li><li class="dropdown-item"><!----> <a href="/blog/recommenderSystem/" class="nav-link">
  RecommenderSystem
</a></li><li class="dropdown-item"><!----> <a href="/blog/ObjectDetection/" class="nav-link">
  ObjectDetection
</a></li><li class="dropdown-item"><!----> <a href="/blog/os/" class="nav-link">
  OperatorSystem
</a></li><li class="dropdown-item"><!----> <a href="/blog/cookies/" class="nav-link">
  Cookies
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/lianyongxing" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/index.html" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Blog" class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/NLP/" class="nav-link">
  NLP
</a></li><li class="dropdown-item"><!----> <a href="/blog/machineLearning/" class="nav-link router-link-active">
  MachineLearning
</a></li><li class="dropdown-item"><!----> <a href="/blog/Papers/" class="nav-link">
  Papers
</a></li><li class="dropdown-item"><!----> <a href="/blog/recommenderSystem/" class="nav-link">
  RecommenderSystem
</a></li><li class="dropdown-item"><!----> <a href="/blog/ObjectDetection/" class="nav-link">
  ObjectDetection
</a></li><li class="dropdown-item"><!----> <a href="/blog/os/" class="nav-link">
  OperatorSystem
</a></li><li class="dropdown-item"><!----> <a href="/blog/cookies/" class="nav-link">
  Cookies
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/lianyongxing" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/machineLearning/" class="sidebar-link">概述</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>损失函数</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>支持向量机SVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>决策树(Decision Tree)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>聚类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>最邻近规则分类(KNN)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>期望最大化(EM)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>集成学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>神经网络算法(NN)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>简单线性回归</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>最大熵模型</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>多元线性回归</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深度学习概述</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>梯度下降算法</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/machineLearning/梯度下降算法/梯度下降算法.html" class="active sidebar-link">梯度下降算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/machineLearning/梯度下降算法/梯度下降算法.html#实例" class="sidebar-link">实例</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Cross-Entropy Cost</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Softmax &amp; Overfitting</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Regularization &amp; Dropout</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深度神经网络的训练难点</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CNN</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="梯度下降算法"><a href="#梯度下降算法" class="header-anchor">#</a> 梯度下降算法</h1> <p>两个隐藏层的神经网络（输入层+隐藏层+输出层），MultiLayer Perceptions（MLP）：实际是sigmoid neurons，不是perceptions（0、1取值）</p> <div align="center"><img src="/assets/img/Image62.1fbe6305.png" width="60%" height="60%" alt="图片名称"></div> <h2 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h2> <p>利用梯度下降算法结合神经网络识别手写数字MNIST数据集：</p> <ul><li>训练数据集：60000张图片</li> <li>测试数据集：10000张图片</li></ul> <p>输入为每一张图片（28*28）中的784个像素点，每个值代表图片中一个像素值</p> <p>如果输入的某个图片是数字6，则期待的理想输出应该为</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><msup><mo>)</mo><mi>T</mi></msup><mo>:</mo></mrow><annotation encoding="application/x-tex">y(x) = (0,0,0,0,0,0,1,0,0,0)^T:
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">:</span></span></span></span></span></p> <h3 id="目标函数"><a href="#目标函数" class="header-anchor">#</a> 目标函数</h3> <p>首先要确定一个目标函数，将代价函数作为目标函数<br>
Cost function（loss function， objective function）目标函数：</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn><mi>n</mi></mrow></mfrac><msub><mo>∑</mo><mi>x</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>−</mo><mi>a</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">C(w,b) = \frac{1}{2n}\sum_x||y(x)-a||^2
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.5714449999999998em;vertical-align:-1.250005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit">n</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.150005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">a</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathrm">∣</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p> <p>其中：</p> <ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>:</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">C:cost</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">:</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit">t</span></span></span></span></li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>:</mo><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">w:weight</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mrel">:</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathit">e</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">h</span><span class="mord mathit">t</span></span></span></span>权重</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>:</mo><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">b:bias</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span><span class="mrel">:</span><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit">s</span></span></span></span>偏向</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">n:</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mrel">:</span></span></span></span>训练集实例的个数</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">x:</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">:</span></span></span></span>输入值</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">a:</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span><span class="mrel">:</span></span></span></span>输出值</li> <li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">||v||:</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mrel">:</span></span></span></span>向量的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mspace width="1em"></mspace><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">length \quad function</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">t</span><span class="mord mathit">h</span><span class="mord mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span></span></span></span></li></ul> <p>因此需要<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C(w,b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span>越小越好，输出的预测值和真实值的差距越来越小，因此目标是最小化<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C(w,b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span></p> <h3 id="梯度下降"><a href="#梯度下降" class="header-anchor">#</a> 梯度下降</h3> <p>最小化问题可以用梯度下降（gradient descent）算法解决</p> <div align="center"><img src="data:image/jpeg;base64,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" width="50%" height="50%" alt="图片名称"></div> <h4 id="核心思想"><a href="#核心思想" class="header-anchor">#</a> 核心思想</h4> <p>对于一个单一变量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>的曲线，要找到这个曲线的最低点的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>坐标，可以从曲线上的任何一点开始，去求曲线在该点的斜率，然后用该点的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>坐标减去斜率（可以尝试一下，无论是在最低点的左边还是右边，这样都可以不断靠近最低点，因为当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>大于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>时，斜率是正的；当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>小于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>时，斜率是负的），在逼近<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的过程中，斜率的值也会不断减少，当达到最低点的时候，斜率正好为零，不会再发生变化，所以用斜率（梯度）来做为迭代过程的调节因子实在是很合适。</p> <p>当函数存在多个变量时，构成的是高维的空间曲面，这时同样要去找到这个最低点，如下图所示：</p> <div align="center"><img src="/assets/img/Image72.b78698b3.png" width="60%" height="60%" alt="图片名称"></div> <p>此时，要进行估计<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">w_k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">b_l</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的值，就需要求偏导数</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>k</mi></msub><mo>→</mo><msubsup><mi>w</mi><mrow><mi>k</mi></mrow><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow></msubsup><mo>=</mo><msub><mi>w</mi><mi>k</mi></msub><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>k</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_k \rightarrow w^{'}_{k} = w_k - \eta \frac{\partial C}{\partial w_{k}}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.247em;margin-left:-0.02691em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>l</mi></msub><mo>→</mo><msubsup><mi>b</mi><mrow><mi>l</mi></mrow><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow></msubsup><mo>=</mo><msub><mi>w</mi><mi>k</mi></msub><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mrow><mi>l</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">b_l \rightarrow b^{'}_{l} = w_k - \eta \frac{\partial C}{\partial b_{l}}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">η</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathit">b</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">∂</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p> <p>不断迭代更新权重<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">weight</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathit">e</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">h</span><span class="mord mathit">t</span></span></span></span>和偏向<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">bias</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit">s</span></span></span></span>，最终找到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span></span></span></span>，使得目标函数最小。</p> <p>有几点需要注意：</p> <ul><li>最终可能达到局部最优而不是全局最优（与初始点的选取有关）</li> <li>目标函数必须是凸函数（就是碗状的，有最低点）</li> <li>学习率（斜率）会自动减小</li></ul> <h4 id="梯度是函数最快上升的方向"><a href="#梯度是函数最快上升的方向" class="header-anchor">#</a> 梯度是函数最快上升的方向</h4> <p>根据泰勒展开式</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo><mo>+</mo><mo>(</mo><mi>θ</mi><mo>−</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>)</mo><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x) = f(x_0) + (\theta - \theta_0) \nabla f(\theta_0)
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>−</mo><msub><mi>θ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\theta - \theta_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>代表了步进的信息（包括方向和大小），是一个矢量，因此当从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>前进时，要得到最大的前进值，当且仅当这个前进方向与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo>(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\nabla f(\theta_0)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∇</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>（也就是当前值的梯度方向）相同的时候，此时</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mo>=</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mo>⋅</mo><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mo>⋅</mo><mi mathvariant="normal">∣</mi><mi>b</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\vec a \cdot \vec b = |a| \cdot |b| cos \theta = |a| \cdot |b|
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.9778799999999999em;"></span><span class="strut bottom" style="height:1.2278799999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit">a</span></span><span style="top:0em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body accent-vec"><span>⃗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⋅</span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord mathit">b</span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body accent-vec"><span>⃗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">∣</span><span class="mord mathit">a</span><span class="mord mathrm">∣</span><span class="mbin">⋅</span><span class="mord mathrm">∣</span><span class="mord mathit">b</span><span class="mord mathrm">∣</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mrel">=</span><span class="mord mathrm">∣</span><span class="mord mathit">a</span><span class="mord mathrm">∣</span><span class="mbin">⋅</span><span class="mord mathrm">∣</span><span class="mord mathit">b</span><span class="mord mathrm">∣</span></span></span></span></span></p> <p>取到最大值。（此时两个矢量的方向相同）</p> <p>因此梯度方向是函数上升最快的方向，梯度方向的反方向是函数下降最快的方向，因此用梯度下降法。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/machineLearning/深度学习概述/深度学习.html" class="prev">
        深度学习
      </a></span> <span class="next"><a href="/blog/machineLearning/Cross-EntropyCost.html">
        Cross-Entropy Cost
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.acaacfed.js" defer></script><script src="/assets/js/2.858fe96a.js" defer></script><script src="/assets/js/32.741f73e3.js" defer></script>
  </body>
</html>
